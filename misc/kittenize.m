% Add a random kitten to a figure
%
%SYNOPSYS
% KITTENIZE(fig_h, scale, pos, filled)
%
%INPUT
%
%
%OUTPUT
%

% TODO
% * randomize kitten position

function kittenize(fig_h, scale, pos, filled)

if nargin < 4
    filled = 0;
end

ax      = fig_h.CurrentAxes;

xminmax = xlim(ax);
yminmax = ylim(ax);

if nargin < 2
    scale = 0.05*min([diff(xminmax), diff(yminmax)]);
end

if nargin < 3
    pos(1) = xminmax(1) + rand(1)*diff(xminmax);
    pos(2) = yminmax(1) + rand(1)*diff(yminmax);
end

% scale due to uneven axis limits
yscale  = diff(yminmax)/diff(xminmax);

% characteristics of the kitten
cx      = 184.5459; % centroid in x direction
cy      = 84.7251;  % centroid in y direction
dy      = 37.8252;  % length in y direction

K       = kitten_coord;

% Translation
T1      = repmat([cx, cy], size(K,1), 1);
T2      = repmat([pos(1), pos(2)], size(K,1), 1);

% Rotatation - by deafault the kitten is upside down
theta   = 180*2*pi/360;
R       = [cos(theta), -sin(theta); sin(theta), cos(theta)];

% Scale
lambda  = 1/dy*scale;
S       = lambda*eye(2,2);
S(2,2)  = S(2,2)*yscale;

K       = (K - T1)*R*S + T2;

hold on
if filled == 0
    plot(K(:,1), K(:,2), 'black', 'LineWidth', 0.01)
elseif filled == 1
    fill(K(:,1), K(:,2), [0,0,0])
else
    error('Fill should be 0 or 1!')
end

xlim(xminmax)
ylim(yminmax)

    function K = kitten_coord
        % Kitten coordinates
        K = [183.2822265625,97.337890625;
            182.14453125,97.458984375;
            181.10595703125,97.5859375;
            180.14013671875,97.6611328125;
            179.2197265625,97.62890625;
            178.26416015625,97.28125;
            177.7666015625,96.61328125;
            177.77587890625,95.78125;
            178.341796875,94.943359375;
            179.04931640625,94.083984375;
            179.3974609375,93.1728515625;
            179.46484375,92.197265625;
            179.33251953125,91.1435546875;
            179,89.072265625;
            178.87255859375,87;
            179.0927734375,84.93505859375;
            179.80419921875,82.8818359375;
            178.505859375,82.2451171875;
            177.33447265625,81.44921875;
            176.3173828125,80.46923828125;
            175.48095703125,79.2783203125;
            174.8125,77.7353515625;
            174.5224609375,76.16162109375;
            174.5966796875,74.55908203125;
            175.021484375,72.927734375;
            175.12841796875,72.595703125;
            175.2060546875,72.2451171875;
            175.2314453125,71.8984375;
            175.18359375,71.5791015625;
            174.931640625,70.08349609375;
            175.076171875,68.6494140625;
            175.5341796875,67.23876953125;
            176.22412109375,65.8125;
            179.45947265625,67.60205078125;
            182.703125,68.2109375;
            185.95703125,67.6220703125;
            189.2216796875,65.81787109375;
            189.9375,67.2275390625;
            190.3955078125,68.65576171875;
            190.5185546875,70.1279296875;
            190.228515625,71.66943359375;
            190.1748046875,71.8857421875;
            190.150390625,72.11572265625;
            190.158203125,72.34521484375;
            190.203125,72.5595703125;
            190.798828125,75.65771484375;
            190.423828125,78.25634765625;
            189.0322265625,80.4697265625;
            186.58203125,82.412109375;
            186.5400390625,82.4453125;
            186.513671875,82.47509765625;
            186.51171875,82.4833984375;
            186.5419921875,82.453125;
            187,83.7880859375;
            187.44921875,85.0986328125;
            187.8984375,86.390625;
            188.3564453125,87.6708984375;
            188.4462890625,87.837890625;
            188.5830078125,87.994140625;
            188.748046875,88.125;
            188.9208984375,88.21484375;
            190.2880859375,88.9873046875;
            191.1572265625,90.052734375;
            191.59765625,91.365234375;
            191.6767578125,92.880859375;
            191.6875,93.47265625;
            191.80859375,93.9853515625;
            192.0859375,94.4423828125;
            192.5634765625,94.8671875;
            193.61328125,95.822265625;
            194.291015625,96.9521484375;
            194.5693359375,98.244140625;
            194.4169921875,99.6845703125;
            193.791015625,101.201171875;
            192.7802734375,102.44140625;
            191.4765625,103.2919921875;
            189.96875,103.6376953125;
            188.94921875,103.611328125;
            187.9228515625,103.4765625;
            186.9033203125,103.265625;
            185.9013671875,103.005859375;
            185.35546875,102.728515625;
            185.0234375,102.28515625;
            184.9404296875,101.71875;
            185.140625,101.072265625;
            185.5146484375,100.548828125;
            185.9814453125,100.236328125;
            186.5517578125,100.1357421875;
            187.2392578125,100.2470703125;
            188.0576171875,100.4658203125;
            188.892578125,100.640625;
            189.7333984375,100.75;
            190.568359375,100.7724609375;
            191.275390625,100.6064453125;
            191.81640625,100.1943359375;
            192.1806640625,99.5869140625;
            192.3603515625,98.837890625;
            192.294921875,98.0703125;
            191.9677734375,97.4755859375;
            191.4453125,97.025390625;
            190.794921875,96.69140625;
            190.5634765625,96.6591796875;
            190.29296875,96.708984375;
            190.013671875,96.80859375;
            189.75390625,96.92578125;
            188.05859375,97.591796875;
            186.3935546875,97.9287109375;
            184.79052734375,97.8671875;
            183.2822265625,97.337890625];
    end

end